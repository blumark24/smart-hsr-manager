<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Smart HSR | Ù„ÙˆØ­Ø© Ø§Ù„Ù‚ÙŠØ§Ø¯Ø© Ø§Ù„ØªÙ†ÙÙŠØ°ÙŠØ© - Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø© ÙˆØ¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬ÙˆØ¯Ø© Ø§Ù„Ø±Ù‚Ù…ÙŠ</title>

  <!-- META -->
  <meta name="description" content="Ù†Ø¸Ø§Ù… Smart HSR Ù„Ù„Ù…Ø±Ø§Ù‚Ø¨Ø© ÙˆØ¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬ÙˆØ¯Ø© Ø§Ù„Ø±Ù‚Ù…ÙŠ - Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… ØªÙ†ÙÙŠØ°ÙŠØ© Ù…ØªÙ‚Ø¯Ù…Ø© Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ù…ÙŠØ¯Ø§Ù†ÙŠØ© ÙˆØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ">
  <meta name="keywords" content="Smart HSR, Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬ÙˆØ¯Ø©, Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø©, Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ…, Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ, ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª">
  <meta name="author" content="Smart HSR">
  <meta name="robots" content="index, follow">
  <meta property="og:title" content="Smart HSR | Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø© ÙˆØ¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬ÙˆØ¯Ø© Ø§Ù„Ø±Ù‚Ù…ÙŠ">
  <meta property="og:description" content="Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… ØªÙ†ÙÙŠØ°ÙŠØ© Ù…ØªÙ‚Ø¯Ù…Ø© Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ù…ÙŠØ¯Ø§Ù†ÙŠØ© ÙˆØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ">
  <meta property="og:type" content="website">
  <meta property="og:locale" content="ar_SA">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Smart HSR | Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø© ÙˆØ¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬ÙˆØ¯Ø© Ø§Ù„Ø±Ù‚Ù…ÙŠ">
  <meta name="twitter:description" content="Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… ØªÙ†ÙÙŠØ°ÙŠØ© Ù…ØªÙ‚Ø¯Ù…Ø© Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ù…ÙŠØ¯Ø§Ù†ÙŠØ©">

  <!-- ASSETS -->
  <link rel="icon" type="image/svg+xml" href="favicon.svg">
  <link rel="alternate icon" href="favicon.ico">
  <link rel="apple-touch-icon" href="favicon.svg">
  <link rel="stylesheet" href="output.css">
  <script src="https://unpkg.com/lucide@latest"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800;900&display=swap" rel="stylesheet">

  <!-- STYLES -->
  <style>
    :root {
      --color-navy:#0A1931;
      --color-teal:#18A5A2;
      --color-light-teal:#ACE2E1;
      --color-gray-bg:#F7F9FC;
      --color-shadow-base:rgba(10,25,49,.4);
      --primary-teal:#0ea5a1;
      --secondary-navy:#0b2b3a;
      --white:#ffffff;
    }

    body {
      font-family:'Tajawal',sans-serif;
      background-color:var(--color-gray-bg);
      color:var(--color-navy);
      padding-top:68px;
    }

    .kpi-open-gradient{
      background:linear-gradient(135deg,#EF4444 0%,#B91C1C 100%);
      color:#fff;
      box-shadow:0 10px 20px rgba(185,28,28,.4)
    }
    .kpi-closed-gradient{
      background:linear-gradient(135deg,#10B981 0%,#18A5A2 100%);
      color:#fff;
      box-shadow:0 10px 20px rgba(24,165,162,.4)
    }
    .kpi-images-gradient{
      background:linear-gradient(135deg,#3B82F6 0%,#0A1931 100%);
      color:#fff;
      box-shadow:0 10px 20px rgba(59,130,246,.4)
    }
    .kpi-missing-gradient{
      background:linear-gradient(135deg,#FCD34D 0%,#F97316 100%);
      color:var(--color-navy);
      box-shadow:0 10px 20px rgba(253,211,77,.4)
    }
    .kpi-card-professional{
      transition:.3s;
      border-radius:1.5rem;
      position:relative;
      overflow:hidden;
      transform:perspective(1px) translateZ(0)
    }
    .kpi-card-professional::before{
      content:"";
      position:absolute;
      bottom:0;
      left:0;
      right:0;
      height:5px;
      background-color:rgba(255,255,255,.2);
      transition:height .3s
    }
    .kpi-card-professional:hover{
      transform:translateY(-8px) scale(1.02);
      z-index:10
    }
    .kpi-card-professional:hover::before{
      height:100%;
      opacity:.1
    }

    .ai-button-primary{
      background:var(--color-teal);
      color:#fff;
      transition:.3s;
      box-shadow:0 6px 15px rgba(24,165,162,.5)
    }
    .ai-button-primary:hover:not(:disabled){
      background:#148f8c;
      transform:translateY(-2px);
      box-shadow:0 8px 20px rgba(24,165,162,.8)
    }
    .ai-button-secondary{
      background:var(--color-navy);
      color:#fff;
      transition:.3s;
      box-shadow:0 4px 10px rgba(10,25,49,.6)
    }
    .ai-button-secondary:hover:not(:disabled){
      background:#1a3053;
      transform:translateY(-2px);
      box-shadow:0 6px 15px rgba(10,25,49,.8)
    }
    .ai-button-vision{
      background:#9333ea;
      color:#fff;
      transition:.3s;
      box-shadow:0 6px 15px rgba(147,51,234,.5)
    }
    .ai-button-vision:hover:not(:disabled){
      background:#7e22ce;
      transform:translateY(-2px);
      box-shadow:0 8px 20px rgba(147,51,234,.8)
    }
    .ai-button-root-cause{
      background:#881337;
      color:#fff;
      transition:.3s;
      box-shadow:0 6px 15px rgba(136,19,55,.5)
    }
    .ai-button-root-cause:hover:not(:disabled){
      background:#9f1239;
      transform:translateY(-2px);
      box-shadow:0 8px 20px rgba(136,19,55,.8)
    }
    .ai-button-comm{
      background:#F97316;
      color:#fff;
      transition:.3s;
      box-shadow:0 6px 15px rgba(249,115,22,.5)
    }
    .ai-button-comm:hover:not(:disabled){
      background:#ea580c;
      transform:translateY(-2px);
      box-shadow:0 8px 20px rgba(249,115,22,.8)
    }
    .ai-button-grounding{
      background:#10B981;
      color:#fff;
      transition:.3s;
      box-shadow:0 6px 15px rgba(16,185,129,.5)
    }
    .ai-button-grounding:hover:not(:disabled){
      background:#059669;
      transform:translateY(-2px);
      box-shadow:0 8px 20px rgba(16,185,129,.8)
    }

    .loading-spinner{
      border:4px solid rgba(255,255,255,.3);
      border-top:4px solid var(--color-light-teal);
      border-radius:50%;
      width:20px;
      height:20px;
      animation:spin 1s linear infinite;
      margin-left:8px
    }
    .ai-button-primary .loading-spinner,
    .ai-button-vision .loading-spinner,
    .ai-button-comm .loading-spinner,
    .ai-button-grounding .loading-spinner,
    .ai-button-secondary .loading-spinner,
    .ai-button-root-cause .loading-spinner{
      border-top:4px solid #0A1931
    }
    @keyframes spin{
      0%{transform:rotate(0)}
      100%{transform:rotate(360deg)}
    }

    .image-container{
      position:relative;
      overflow:hidden;
      border-radius:.75rem;
      box-shadow:0 4px 10px var(--color-shadow-base)
    }
    .image-label{
      position:absolute;
      bottom:0;
      right:0;
      background:var(--color-navy);
      color:#fff;
      padding:.5rem 1rem;
      font-size:.875rem;
      font-weight:700;
      border-top-left-radius:.75rem
    }

    .observation-item{
      transition:.2s;
      border-right:4px solid transparent;
      cursor:pointer
    }
    .observation-item:hover{
      background:#E6F3F3;
      border-right-color:var(--color-teal)
    }
    .observation-item.active{
      background:#E6F3F3;
      border-right-color:var(--color-navy);
      box-shadow:0 0 10px rgba(0,0,0,.1)
    }

    .comparison-wrapper{
      position:relative;
      max-width:100%;
      overflow:hidden;
      user-select:none;
      cursor:ew-resize;
      border-radius:.75rem
    }
    .comparison-wrapper img,
    .comparison-wrapper video{
      display:block;
      width:100%;
      height:auto
    }
    .comparison-wrapper .after-image{
      position:absolute;
      top:0;
      left:0;
      height:100%;
      width:50%;
      overflow:hidden
    }
    .comparison-wrapper .after-image img,
    .comparison-wrapper .after-image video{
      position:absolute;
      top:0;
      left:0;
      width:100%;
      height:auto
    }
    .comparison-wrapper .comparison-divider{
      position:absolute;
      top:0;
      left:50%;
      width:4px;
      height:100%;
      background:var(--color-teal);
      transform:translateX(-50%);
      cursor:grab;
      z-index:10;
      box-shadow:0 0 10px rgba(24,165,162,.8);
      border-radius:2px;
      transition:width .1s
    }
    .comparison-wrapper .comparison-divider:active{
      cursor:grabbing
    }
    .comparison-wrapper .comparison-divider-handle{
      position:absolute;
      top:50%;
      left:50%;
      transform:translate(-50%,-50%);
      width:40px;
      height:40px;
      background:#fff;
      border:3px solid var(--color-teal);
      border-radius:50%;
      display:flex;
      align-items:center;
      justify-content:center;
      box-shadow:0 0 15px rgba(0,0,0,.3)
    }
    .comparison-label{
      position:absolute;
      z-index:5;
      padding:.5rem 1rem;
      font-size:.875rem;
      font-weight:700;
      color:#fff;
      border-radius:.5rem;
      opacity:.9;
      box-shadow:0 2px 5px rgba(0,0,0,.2)
    }
    .label-before{top:10px; right:10px; background:#B91C1C}
    .label-after{top:10px; left:10px; background:#10B981}

    .communication-draft{
      white-space:pre-wrap;
      text-align:right;
      direction:rtl;
      font-family:'Tajawal',sans-serif;
      border-right:4px solid var(--color-teal);
      padding-right:1rem;
      line-height:1.8;
      background:#f8fafc
    }

    .kpi-insight-container{
      border-radius:1.5rem;
      box-shadow:0 10px 30px rgba(0,0,0,.1);
      border-top:5px solid var(--color-navy)
    }

    .source-link{
      color:#0d9488;
      text-decoration:none;
      transition:color .2s
    }
    .source-link:hover{
      color:var(--color-navy);
      text-decoration:underline
    }

    audio{width:100%; margin-top:10px}

    .modal{
      display:none;
      position:fixed;
      z-index:100;
      left:0;
      top:0;
      width:100%;
      height:100%;
      overflow:auto;
      background:rgba(0,0,0,.6);
      align-items:center;
      justify-content:center
    }
    .modal-content{
      background:#fefefe;
      margin:5% auto;
      padding:30px;
      border-radius:1.5rem;
      width:90%;
      max-width:800px;
      box-shadow:0 10px 40px rgba(0,0,0,.3);
      animation:slide-up .3s ease-out;
      position:relative
    }

    .input-group-wrapper{
      display:flex;
      gap:1rem
    }
    .input-group{
      flex-grow:1;
      text-align:center
    }

    @keyframes slide-up{
      0%{opacity:0;transform:translateY(20px)}
      100%{opacity:1;transform:translateY(0)}
    }

    @media print{
      body{
        background:#fff!important;
        color:#000!important;
        width:210mm;
        min-height:297mm;
        margin:0
      }
      .no-print,
      #observationsList,
      #hero,
      #operational-dashboard,
      #ai-features,
      footer,
      .modal{
        display:none!important
      }
      #observationDetail{
        display:block!important;
        max-width:100%!important;
        margin:0!important;
        padding:0!important;
        box-shadow:none!important;
        border:none!important
      }
      .kpi-insight-container,
      .bg-white{
        box-shadow:none!important;
        border:none!important;
        padding:0!important;
        margin:0!important
      }
      .comparison-wrapper{cursor:default}
      .comparison-divider,
      .comparison-label{display:none!important}
      .comparison-wrapper .after-image{
        width:100%!important;
        overflow:visible!important
      }
      .comparison-wrapper .after-image img{position:static!important}
      .print-logo{display:block!important}
    }

    /* HEADER */
    .hsr-header {
      background: linear-gradient(90deg, var(--secondary-navy) 0%, var(--primary-teal) 100%);
      color: var(--white);
      padding: 0.6rem 1rem;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      z-index: 1000;
      box-shadow: 0 4px 12px rgba(0,0,0,0.25);
      backdrop-filter: blur(6px);
    }

    .hsr-top {
      display:flex;
      align-items:center;
      justify-content:space-between;
      flex-wrap:wrap;
    }

    .brand {
      display:flex;
      align-items:center;
      gap:0.4rem;
      font-size:1.15rem;
      font-weight:700;
    }
    .brand .dot {width:10px;height:10px;background:#22c55e;border-radius:50%;}
    .brand .accent {color:#d1f4f2;}

    .user-info {
      display:flex;
      align-items:center;
      gap:0.6rem;
      background:rgba(255,255,255,0.1);
      padding:6px 12px;
      border-radius:10px;
      box-shadow:0 2px 6px rgba(0,0,0,0.15);
    }
    .user-info .icon {
      width:20px;
      height:20px;
      opacity:0.9;
    }
    .user-text {
      display:flex;
      flex-wrap:wrap;
      align-items:center;
      gap:6px;
      font-weight:600;
      white-space:nowrap;
    }
    #userName {
      font-size:0.95rem;
      font-weight:700;
      color:#fff;
    }
    #userRole {
      font-size:0.8rem;
      border-radius:6px;
      padding:3px 8px;
      text-transform:capitalize;
    }

    .user-role-inspector {
      background:rgba(16,185,129,0.2);
      color:#10b981;
    }
    .user-role-contractor {
      background:rgba(249,115,22,0.2);
      color:#f97316;
    }
    .user-role-manager {
      background:rgba(59,130,246,0.2);
      color:#3b82f6;
    }

    .actions {
      display:flex;
      align-items:center;
      gap:0.5rem;
    }
    .actions .btn {
      display:flex;
      align-items:center;
      gap:0.3rem;
      padding:0.35rem 0.7rem;
      border:none;
      border-radius:8px;
      font-size:0.85rem;
      cursor:pointer;
      transition:all 0.3s ease;
    }
    .btn.primary{background:var(--primary-teal);color:#fff;}
    .btn.dark{background:rgba(255,255,255,0.1);color:#fff;}
    .btn:hover{transform:scale(1.04);opacity:0.9;}

    .gps-indicator{display:flex;align-items:center;gap:0.3rem;}
    .gps-indicator .circle{width:10px;height:10px;border-radius:50%;}
    .circle.off{background:#ef4444;}
    .circle.on{background:#22c55e;}

    .menu-toggle{display:none;background:transparent;border:none;color:#fff;cursor:pointer;}

    @media (max-width:768px){
      .actions{
        display:none;
        flex-direction:column;
        width:100%;
        background:var(--secondary-navy);
        padding:0.7rem;
        border-radius:8px;
        margin-top:0.5rem;
      }
      .actions.active{display:flex;}
      .menu-toggle{display:block;}
      .user-info {
        width:100%;
        justify-content:center;
        margin-top:6px;
      }
    }

    .toast{
      position:fixed;
      bottom:20px;
      right:20px;
      background:#0ea5a1;
      color:white;
      padding:10px 18px;
      border-radius:10px;
      font-size:15px;
      box-shadow:0 6px 18px rgba(0,0,0,0.2);
      opacity:0;
      transform:translateY(10px);
      transition:all 0.4s ease;
      z-index:2000;
    }
    .toast.show{opacity:1;transform:translateY(0);}
    .spin{animation:spin 1s linear infinite;}

    .legend-toggle::after{
      content:"";
      position:absolute;
      inset:-6px;
      border-radius:50%;
      box-shadow:0 0 0 0 rgba(24,165,162,0.45);
      opacity:0;
      pointer-events:none;
      animation:legendSoftRing 5s ease-out infinite;
    }
    .legend-toggle.active::after{animation:none;}
    @media (prefers-reduced-motion: reduce){
      .legend-toggle::after{ animation:none; }
    }
    @keyframes legendSoftRing{
      0%, 80%{
        opacity:0;
        box-shadow:0 0 0 0 rgba(24,165,162,0);
      }
      85%{
        opacity:.6;
        box-shadow:0 0 0 0 rgba(24,165,162,0.45);
      }
      100%{
        opacity:0;
        box-shadow:0 0 0 22px rgba(24,165,162,0);
      }
    }
  </style>

  <link rel="stylesheet" href="modal-style.css">
  <link rel="stylesheet" href="style-custom.css">

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
  import { getGenerativeAI } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-generative-ai.js";

  const firebaseConfig = {
    apiKey: "AIzaSyCXCiNeaO9lhM79tKb98x4oaNqNy5xKvWM",
    authDomain: "smart-hsr-manager.firebaseapp.com",
    projectId: "smart-hsr-manager",
    storageBucket: "smart-hsr-manager.firebasestorage.app",
    messagingSenderId: "38965508031",
    appId: "1:38965508031:web:6fd0b6c6b0b63fa513930a"
  };

  const app = initializeApp(firebaseConfig);
  window.genAI = getGenerativeAI(app);

  window.askAIForNote = async function(noteText) {
    try {
      const model = genAI.getGenerativeModel({ model: "gemini-1.5-flash" });
      const result = await model.generateContent("Ø­Ù„Ù„ Ù‡Ø°Ù‡ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø© ÙˆØ§Ù‚ØªØ±Ø­ ØªØ­Ø³ÙŠÙ†Ø§Øª ÙˆØ§Ø¶Ø­Ø©:\n\n" + noteText);
      return result.response.text();
    } catch (e) { return "Ø®Ø·Ø£: Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ù„Ù… ÙŠØ¹Ù…Ù„."; }
  };
</script>

</head>

<body class="text-gray-800">

<!-- ========== HEADER ========== -->
<header id="hsrHeader" class="hsr-header">
  <div class="hsr-top">
    <div class="brand">
      <span class="dot"></span>
      <strong>Smart HSR</strong>
      <span class="accent">System</span>
    </div>

    <div class="user-info">
      <i data-lucide="user" class="icon"></i>
      <div class="user-text">
        <span id="userFullInfo">
          <span id="userName">â€”</span>
          <span id="userRole" class="role-badge">â€”</span>
        </span>
      </div>
    </div>

    <button id="menuToggle" class="menu-toggle">
      <i data-lucide="menu"></i>
    </button>

    <div class="actions">
      <div id="gpsIndicator" class="gps-indicator" title="Ø­Ø§Ù„Ø© Ø§Ù„Ù…ÙˆÙ‚Ø¹">
        <span class="circle off"></span>
        <small id="gpsText">ØºÙŠØ± Ù…ØªØ§Ø­</small>
      </div>

      <button class="btn primary" onclick="window.open('mobile-map.html','_blank')">
        <i data-lucide='map'></i> <span>Ø§Ù„Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ø°ÙƒÙŠØ©</span>
      </button>

      <button id="logoutBtn" class="btn dark">
        <i data-lucide='log-out'></i> <span>Ø®Ø±ÙˆØ¬</span>
      </button>
    </div>
  </div>
</header>

<main class="max-w-6xl mx-auto px-4 md:px-6 lg:px-8">

  <!-- HERO -->
  <section id="hero" class="text-center py-12 md:py-16 bg-white rounded-3xl shadow-2xl mb-12 border-b-8 border-t-8 border-teal-100 no-print">
    <h1 class="text-5xl md:text-7xl font-extrabold text-gray-900 tracking-tight" style="color:var(--color-navy);">
      Smart HSR <span style="color:var(--color-teal);">Dashboard</span>
    </h1>
    <h2 class="text-xl md:text-3xl font-extrabold text-gray-600 mt-4">Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø© ÙˆØ¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬ÙˆØ¯Ø© Ø§Ù„Ø±Ù‚Ù…ÙŠ</h2>
    <p class="mt-4 text-lg max-w-4xl mx-auto text-gray-500 font-medium">
      "Ù…Ù†ØµØ© ØªÙ†ÙÙŠØ°ÙŠØ© Ø°ÙƒÙŠØ© Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬ÙˆØ¯Ø© ÙˆØ§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø±Ù‚Ù…ÙŠØ©ØŒ ØªÙˆÙØ± Ø±Ø¤ÙŠØ© Ø¯Ù‚ÙŠÙ‚Ø© Ù„Ù„Ø£Ø¯Ø§Ø¡ ÙˆØªØ¯Ø¹Ù… Ø§ØªØ®Ø§Ø° Ø§Ù„Ù‚Ø±Ø§Ø± Ø§Ù„Ù…Ø¨Ù†ÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª."
    </p>
  </section>

  <!-- OBSERVATIONS -->
  <section id="observations-log" class="my-20">
    <div class="text-center mb-12 no-print">
      <h3 class="text-4xl md:text-5xl font-extrabold text-gray-900 mb-3" style="color:var(--color-navy);">
        Ø³Ø¬Ù„ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠ: Ø¯Ù‚Ø© Ø§Ù„ØµÙˆØ±Ø© ÙˆØ§Ù„Ù†Øµ
      </h3>
      <p class="mt-3 text-lg text-gray-600">Ø¹Ø±Ø¶ ØªÙØµÙŠÙ„ÙŠ Ù„Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ù…ÙŠØ¯Ø§Ù†ÙŠØ© Ù…Ø¹ Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¢Ù„ÙŠ.</p>
      <button id="add-observation-btn" class="ai-button-primary rounded-full px-6 py-2 text-md font-bold mt-4 flex items-center justify-center mx-auto" onclick="openModal('smartInputModal')">
        <i data-lucide="plus-circle" class="w-5 h-5 ml-2"></i> Ø¥Ø¶Ø§ÙØ© Ù…Ù„Ø§Ø­Ø¸Ø© Ø¬Ø¯ÙŠØ¯Ø© (Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø°ÙƒÙŠ)
      </button>
    </div>

    <div class="bg-white p-6 md:p-8 rounded-3xl shadow-2xl grid grid-cols-1 lg:grid-cols-3 gap-8 border border-gray-200">
      <!-- List + Filter -->
      <div class="lg:col-span-1 border-b lg:border-b-0 lg:border-l border-gray-300 lg:pr-6 pb-6 lg:pb-0 no-print">
        <h4 class="text-2xl font-bold mb-4" style="color:var(--color-teal);">ØªØµÙÙŠØ© Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª</h4>
        <select id="observationFilter" class="w-full p-3 border border-gray-300 rounded-xl focus:ring-[--color-teal] focus:border-[--color-teal] text-gray-700 shadow-sm transition-all duration-300" onchange="handleFilterChange()">
          <option value="Ø§Ù„ÙƒÙ„">Ø¹Ø±Ø¶ ÙƒÙ„ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª</option>
          <option value="Ø¬Ø¯ÙŠØ¯">Ø¬Ø¯ÙŠØ¯</option>
          <option value="Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°">Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°</option>
          <option value="ØªÙ…Øª Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©">ØªÙ…Øª Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©</option>
          <option value="Ø¬ÙˆØ¯Ø©">Ø¬ÙˆØ¯Ø©</option>
          <option value="ØµÙŠØ§Ù†Ø©">ØµÙŠØ§Ù†Ø©</option>
          <option value="Ø³Ù„Ø§Ù…Ø©">Ø³Ù„Ø§Ù…Ø©</option>
          <option value="Ø¨ÙŠØ¦Ø©">Ø¨ÙŠØ¦Ø©</option>
        </select>

        <h4 class="text-2xl font-bold mt-8 mb-3" style="color:var(--color-navy);">Ø§Ù„Ù…Ù€Ù„Ø§Ø­Ø¸Ù€Ù€Ø§Øª</h4>
        <div id="observationsList" class="space-y-3 max-h-[500px] overflow-y-auto pr-2">
          <div class="text-center text-gray-500 mt-10">... Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ...</div>
        </div>
      </div>

      <!-- Details -->
      <div class="lg:col-span-2 bg-gray-50 p-6 rounded-2xl border border-gray-200 shadow-inner">
        <div class="print-logo hidden mb-6 p-4 border-b border-gray-300">
          <h2 class="text-3xl font-extrabold text-gray-900" style="color:var(--color-navy);">ØªÙ‚Ø±ÙŠØ± Smart HSR Ø§Ù„ØªÙ†ÙÙŠØ°ÙŠ</h2>
          <p id="printTitle" class="text-xl font-bold text-teal-600 mt-2"></p>
        </div>

        <h4 class="text-2xl font-extrabold mb-4 border-b-2 border-gray-300 pb-2" style="color:var(--color-teal);">
          Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ØµÙŠÙ„ ÙˆØ§Ù„ØªØ­Ù„ÙŠÙ„ (AI Insights)
        </h4>

        <div id="observationDetail" class="hidden">
          <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm font-medium mb-6 p-4 bg-white rounded-xl shadow-sm border">
            <div class="border-b md:border-b-0 md:border-l p-2">
              <span class="block text-gray-500">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:</span>
              <span id="detailTitle" class="block font-bold text-gray-800"></span>
            </div>
            <div class="border-b md:border-b-0 md:border-l p-2">
              <span class="block text-gray-500">Ø§Ù„ØªØµÙ†ÙŠÙ:</span>
              <span id="detailType" class="block font-bold text-teal-600"></span>
            </div>
            <div class="p-2">
              <span class="block text-gray-500">Ø§Ù„Ù…ÙˆÙ‚Ø¹:</span>
              <span id="detailLocation" class="block font-bold text-gray-800"></span>
            </div>
            <div class="border-b md:border-b-0 md:border-l p-2">
              <span class="block text-gray-500">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ù„Ø§Øº:</span>
              <span id="detailDate" class="block font-bold text-gray-800"></span>
            </div>
            <div class="border-b md:border-b-0 md:border-l p-2">
              <span class="block text-gray-500">Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©:</span>
              <span id="detailStatus" class="inline-block px-3 py-1 text-sm font-semibold rounded-full text-white"></span>
            </div>
            <div class="p-2">
              <span class="block text-gray-500">Ù…Ø¹Ø±Ù Ø§Ù„Ø¨Ù„Ø§Øº:</span>
              <span id="detailID" class="block font-bold text-gray-800"></span>
            </div>
          </div>

          <div class="bg-white p-5 rounded-2xl shadow-md mb-6 border-l-4 border-teal-500">
            <h5 class="text-xl font-bold mb-3" style="color:var(--color-navy);">ÙˆØµÙ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©</h5>
            <p id="detailDescription" class="text-gray-700 leading-relaxed"></p>
            <div id="actionPlanContainer" class="mt-4 p-3 bg-teal-50 rounded-lg hidden">
              <h6 class="font-bold text-teal-700">Ø®Ø·Ø© Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø© (Gemini AI)</h6>
              <p id="actionPlan" class="text-sm text-teal-900 mt-1"></p>
            </div>
          </div>

          <div id="resolutionNoteContainer" class="bg-green-50 p-5 rounded-2xl shadow-md mb-6 border-l-4 border-green-500 hidden">
            <h5 class="text-xl font-bold mb-3 text-green-700">ğŸ“ Ø§Ù„Ù…Ø°ÙƒØ±Ø© Ø§Ù„Ø®ØªØ§Ù…ÙŠØ© Ù„Ù„Ø¥ØºÙ„Ø§Ù‚</h5>
            <p id="resolutionNote" class="text-gray-700 leading-relaxed"></p>
          </div>

          <div id="imageComparisonWrapper" class="comparison-wrapper mb-6 hidden">
            <img id="beforeImage" class="before-image w-full h-auto" alt="ØµÙˆØ±Ø© Ù‚Ø¨Ù„ Ø§Ù„Ø¥ØµÙ„Ø§Ø­" src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==">
            <div id="afterImageContainer" class="after-image">
              <img id="afterImage" class="w-full h-auto" alt="ØµÙˆØ±Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ØµÙ„Ø§Ø­" src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==">
            </div>
            <div id="comparisonDivider" class="comparison-divider no-print">
              <div class="comparison-divider-handle">
                <i data-lucide="arrow-left-right" class="w-4 h-4 text-teal-600"></i>
              </div>
            </div>
            <span class="comparison-label label-before no-print">Ù‚Ø¨Ù„</span>
            <span class="comparison-label label-after no-print">Ø¨Ø¹Ø¯</span>
          </div>

          <div id="mediaContainer" class="image-container mb-6 hidden">
            <div id="mediaContent" class="w-full h-auto rounded-xl"></div>
            <span class="image-label">Ù…Ø±ÙÙ‚ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©</span>
          </div>

          <div id="noImageMessage" class="bg-yellow-100 p-4 rounded-xl text-center text-yellow-800 font-medium mb-6 hidden">
            <i data-lucide="alert-triangle" class="w-5 h-5 inline-block ml-2"></i>
            Ù„Ø§ ØªØªÙˆÙØ± ØµÙˆØ±Ø© Ø£Ùˆ ÙÙŠØ¯ÙŠÙˆ Ù„Ù‡Ø°Ù‡ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©.
          </div>

          <div id="aiAnalysisSection" class="bg-white p-5 rounded-2xl shadow-md border-t-4 border-gray-200">
            <h5 class="text-xl font-bold mb-4" style="color:var(--color-navy);">Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø°ÙƒÙŠ (Gemini AI)</h5>
            <div class="flex flex-wrap gap-3 no-print">
              <button id="vision-btn" class="ai-button-vision rounded-full px-4 py-2 text-sm font-bold flex items-center" onclick="analyzeImage('vision')">
                <i data-lucide="eye" class="w-4 h-4 ml-2"></i> ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØµÙˆØ± Ø¨Ø§Ù„Ø±Ø¤ÙŠØ© (Vision)
              </button>
              <button id="root-cause-btn" class="ai-button-root-cause rounded-full px-4 py-2 text-sm font-bold flex items-center" onclick="analyzeImage('root-cause')">
                <i data-lucide="microscope" class="w-4 h-4 ml-2"></i> ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø³Ø¨Ø¨ Ø§Ù„Ø¬Ø°Ø±ÙŠ
              </button>
              <button id="comm-btn" class="ai-button-comm rounded-full px-4 py-2 text-sm font-bold flex items-center" onclick="generateCommunicationDraft()">
                <i data-lucide="send" class="w-4 h-4 ml-2"></i> ØµÙŠØ§ØºØ© Ø£Ù…Ø± Ø§Ù„Ø¹Ù…Ù„
              </button>
              <button id="pdf-report-btn" class="ai-button-grounding rounded-full px-4 py-2 text-sm font-bold flex items-center" onclick="generatePdfReport()">
                <i data-lucide="file-text" class="w-4 h-4 ml-2"></i> ØªÙˆÙ„ÙŠØ¯ ØªÙ‚Ø±ÙŠØ± PDF
              </button>
            </div>

            <div id="aiResultContainer" class="mt-5 p-4 bg-gray-50 rounded-xl border border-gray-200 hidden">
              <h6 id="aiResultTitle" class="font-bold text-lg mb-2" style="color:var(--color-teal);"></h6>
              <div id="aiResultContent" class="text-gray-700"></div>
            </div>
          </div>

          <div id="actionButtons" class="mt-6 pt-4 border-t border-gray-300 flex justify-end gap-3 no-print">
            <button id="updateStatusBtn" class="bg-gray-400 hover:bg-gray-500 text-white font-bold py-2 px-4 rounded-full shadow-lg transition duration-150" onclick="alert('ØªÙ… ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø­Ø§Ù„Ø© Ø¥Ù„Ù‰ Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ° (ØªØ¬Ø±ÙŠØ¨ÙŠ)')">
              ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø© Ø¥Ù„Ù‰ "Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°"
            </button>
            <button id="completeObservationBtn" class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-full shadow-lg transition duration-150" onclick="openModal('closeoutModal')">
              <i data-lucide="lock" class="w-4 h-4 ml-2"></i> Ø§Ù„Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ØªÙ†ÙÙŠØ°ÙŠ (ØµÙˆØ±Ø© Ø¨Ø¹Ø¯)
            </button>
            <button id="alreadyCompletedBtn" class="bg-green-600 text-white font-bold py-2 px-4 rounded-full shadow-lg transition duration-150 hidden" disabled>
              <i data-lucide="check" class="w-4 h-4 ml-2"></i> Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø© Ù…ØºÙ„Ù‚Ø© ÙˆÙ…ÙˆØ«Ù‚Ø©
            </button>
          </div>
        </div>

        <div id="detailPlaceholder" class="text-center space-y-4">
          <p class="text-gray-500 mt-16 text-lg">Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ø§Ø­Ø¸Ø© Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ù„Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ±Ø© ÙˆØ§Ù„Ù…Ø°ÙƒØ±Ø© Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ©.</p>
          <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 mx-auto text-gray-300" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M17 10h.01"/>
          </svg>
        </div>
      </div>
    </div>
  </section>

  <!-- KPIs -->
  <section id="operational-dashboard" class="my-20 no-print">
    <div class="text-center mb-12">
      <h3 class="text-4xl md:text-5xl font-extrabold text-gray-900 mb-3" style="color:var(--color-navy);">
        ğŸ“Š Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø­ÙŠÙˆÙŠØ© (Vital Metrics)
      </h3>
      <p class="mt-3 text-lg text-gray-600">
        ØªØªØ¨Ø¹ Ø§Ù„Ø¨Ù„Ø§ØºØ§Øª ÙˆØ­Ø§Ù„Ø© Ø§Ù„ØªÙˆØ«ÙŠÙ‚ Ø¨Ø§Ù„ØµÙˆØ± Ù„Ø¶Ù…Ø§Ù† ÙƒÙØ§Ø¡Ø© Ø§Ù„Ø¥ØºÙ„Ø§Ù‚.
      </p>
    </div>

    <div id="kpiContainer" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8">
      <div class="p-6 bg-white rounded-2xl shadow-xl border-t-4 border-gray-200">
        <p class="text-xl font-medium text-gray-500">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</p>
        <p class="text-5xl font-extrabold text-gray-700 mt-2">--</p>
      </div>
    </div>

    <div class="mt-12 text-center">
      <button id="kpi-insight-button" class="ai-button-secondary rounded-full px-8 py-3 text-lg font-bold flex items-center justify-center mx-auto" onclick="generateKpiInsights()">
        <i data-lucide="bar-chart-3" class="w-5 h-5 ml-2"></i>
        âœ¨ ØªÙˆÙ„ÙŠØ¯ ØªÙ‚Ø±ÙŠØ± ØªÙ†ÙÙŠØ°ÙŠ Ù„Ù…Ù„Ø®Øµ Ø§Ù„Ù„ÙˆØ­Ø© (Gemini AI)
      </button>
      <div id="kpi-insight-result" class="mt-6 text-sm"></div>
    </div>
  </section>

  <!-- AI FEATURES -->
  <section id="ai-features" class="my-20 bg-white p-8 md:p-12 rounded-3xl shadow-2xl border-t-8 border-[--color-teal] no-print">
    <div class="text-center mb-12">
      <h3 class="text-4xl md:text-5xl font-extrabold text-gray-900 mb-3" style="color:var(--color-navy);">
        ğŸ§  Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ ÙÙŠ ØµÙ…ÙŠÙ… Ø§Ù„Ø¹Ù…Ù„ÙŠØ©
      </h3>
      <p class="mt-3 text-lg text-gray-600">
        Ø§Ø³ØªÙØ¯ Ù…Ù† Ù†Ù…Ø§Ø°Ø¬ Gemini Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ Ù‚Ø±Ø§Ø±Ø§Øª Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªÙ†ÙÙŠØ°.
      </p>
    </div>
    <div class="grid grid-cols-1 sm:grid-cols-3 md:grid-cols-7 gap-8 text-center">
      <div class="p-4 rounded-xl border border-gray-100 bg-gray-50 hover:shadow-lg transition-shadow duration-300 flex flex-col items-center">
        <span class="text-4xl block mb-2" style="color:#9333ea;">ğŸ‘ï¸</span>
        <h4 class="font-extrabold text-lg mb-1" style="color:var(--color-navy);">ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø±Ø¤ÙŠØ©</h4>
        <p class="text-xs text-gray-600">ÙˆØµÙ Ø§Ù„Ù…Ø´ÙƒÙ„Ø© ÙˆØªØ­Ø¯ÙŠØ¯ Ø­Ø§Ù„Ø© Ø§Ù„Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù…Ø«Ø§Ù„ÙŠØ©.</p>
      </div>
      <div class="p-4 rounded-xl border border-gray-100 bg-gray-50 hover:shadow-lg transition-shadow duration-300 flex flex-col items-center">
        <span class="text-4xl block mb-2" style="color:var(--color-teal);">âš™ï¸</span>
        <h4 class="font-bold text-lg mb-1" style="color:var(--color-navy);">Ø®Ø·Ø© Ø¹Ù…Ù„ Ø¢Ù„ÙŠØ©</h4>
        <p class="text-xs text-gray-600">ØªÙˆÙ„ÙŠØ¯ Ø®Ø·ÙˆØ§Øª ØªÙ†ÙÙŠØ°ÙŠØ© Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©.</p>
      </div>
      <div class="p-4 rounded-xl border border-gray-100 bg-gray-50 hover:shadow-lg transition-shadow duration-300 flex flex-col items-center">
        <span class="text-4xl block mb-2" style="color:var(--color-teal);">ğŸš¨</span>
        <h4 class="font-bold text-lg mb-1" style="color:var(--color-navy);">ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø®Ø§Ø·Ø±</h4>
        <p class="text-xs text-gray-600">ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ© ÙˆØ§Ù„Ø¥Ø·Ø§Ø± Ø§Ù„Ø²Ù…Ù†ÙŠ ÙÙŠ Ù‡ÙŠÙƒÙ„ JSON.</p>
      </div>
      <div class="p-4 rounded-xl border border-gray-100 bg-gray-50 hover:shadow-lg transition-shadow duration-300 flex flex-col items-center">
        <span class="text-4xl block mb-2" style="color:#881337;">ğŸ”¬</span>
        <h4 class="font-bold text-lg mb-1" style="color:var(--color-navy);">ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø³Ø¨Ø¨ Ø§Ù„Ø¬Ø°Ø±ÙŠ</h4>
        <p class="text-xs text-gray-600">Ø§Ù‚ØªØ±Ø§Ø­ Ø³Ø¨Ø¨ Ø¬Ø°Ø±ÙŠ ÙˆÙ†ØµÙŠØ­Ø© ÙˆÙ‚Ø§Ø¦ÙŠØ©.</p>
      </div>
      <div class="p-4 rounded-xl border border-gray-100 bg-gray-50 hover:shadow-lg transition-shadow duration-300 flex flex-col items-center">
        <span class="text-4xl block mb-2" style="color:#F97316;">âœ‰ï¸</span>
        <h4 class="font-bold text-lg mb-1" style="color:var(--color-navy);">ØµÙŠØ§ØºØ© Ø§Ù„Ø§ØªØµØ§Ù„</h4>
        <p class="text-xs text-gray-600">ØªÙˆÙ„ÙŠØ¯ Ù…Ø³ÙˆØ¯Ø© Ø£Ù…Ø± Ø¹Ù…Ù„ Ø£Ùˆ Ø¨Ø±ÙŠØ¯ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ.</p>
      </div>
      <div class="p-4 rounded-xl border border-gray-100 bg-gray-50 hover:shadow-lg transition-shadow duration-300 flex flex-col items-center">
        <span class="text-4xl block mb-2" style="color:var(--color-navy);">ğŸ”Š</span>
        <h4 class="font-bold text-lg mb-1" style="color:var(--color-navy);">ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ØµÙˆØªÙŠ</h4>
        <p class="text-xs text-gray-600">ØªÙ„Ø®ÙŠØµ Ø§Ù„ØªÙ‚Ø±ÙŠØ± ÙˆØªØ­ÙˆÙŠÙ„Ù‡ Ø¥Ù„Ù‰ Ù…Ù„Ù ØµÙˆØªÙŠ.</p>
      </div>
      <div class="p-4 rounded-xl border border-gray-100 bg-gray-50 hover:shadow-lg transition-shadow duration-300 flex flex-col items-center">
        <span class="text-4xl block mb-2" style="color:#10B981;">ğŸŒ</span>
        <h4 class="font-bold text-lg mb-1" style="color:var(--color-navy);">Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ø¹Ø§ÙŠÙŠØ±</h4>
        <p class="text-xs text-gray-600">Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ù…Ø¯Ø¹ÙˆÙ… Ù„Ø§Ø³ØªØ­Ø¶Ø§Ø± Ø§Ù„Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠØ©.</p>
      </div>
    </div>
  </section>

  <!-- FOOTER -->
  <footer class="text-center mt-20 py-12 border-t-4 border-teal-200 bg-white rounded-t-3xl shadow-2xl no-print">
    <div class="max-w-6xl mx-auto px-4">
      <h3 class="text-3xl md:text-4xl font-extrabold mb-4" style="color:var(--color-navy);">
        Ø§Ø¨Ø¯Ø£ Ø±Ø­Ù„Ø© Ø§Ù„ØªØ­ÙˆÙ„ Ø§Ù„Ø±Ù‚Ù…ÙŠ Ù…Ø¹ Smart HSR
      </h3>
      <p class="mt-3 text-lg md:text-xl text-gray-600 max-w-3xl mx-auto">
        Ù†Ø¸Ø§Ù… Ø°ÙƒÙŠ ÙŠÙØ­ÙˆÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙŠØ¯Ø§Ù† Ø¥Ù„Ù‰ Ù‚Ø±Ø§Ø±Ø§Øª Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© ØªÙ†ÙÙŠØ°ÙŠÙ‘Ø©
      </p>
      <a href="http://wa.me/966507006849" target="_blank" class="mt-8 inline-block bg-[--color-teal] text-white font-bold py-4 px-12 rounded-full text-xl hover:bg-[--color-navy] transition-all duration-300 transform hover:scale-105 shadow-lg">
        Ø§Ø·Ù„Ø¨ Ø¹Ø±Ø¶Ù‹Ø§ ØªØ¬Ø±ÙŠØ¨ÙŠÙ‹Ø§ Ø§Ù„Ø¢Ù†
      </a>
      <div class="mt-12 pt-8 border-t border-gray-200">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 text-sm text-gray-600 mb-6">
          <div>
            <h4 class="font-bold text-gray-800 mb-2">Ø­ÙˆÙ„ Ø§Ù„Ù†Ø¸Ø§Ù…</h4>
            <p>Ù†Ø¸Ø§Ù… Smart HSR Ù„Ù„Ù…Ø±Ø§Ù‚Ø¨Ø© ÙˆØ¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬ÙˆØ¯Ø© Ø§Ù„Ø±Ù‚Ù…ÙŠ</p>
          </div>
          <div>
            <h4 class="font-bold text-gray-800 mb-2">Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ</h4>
            <p>Blumark24@gmail.com</p>
          </div>
          <div>
            <h4 class="font-bold text-gray-800 mb-2">Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª ÙˆØ§Ù„Ø§Ø³ØªÙØ³Ø§Ø±Ø§Øª</h4>
            <p>0507006849</p>
          </div>
        </div>
        <div class="text-xs text-gray-500">
          <p class="mb-2">&copy; 2025 Smart HSR. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©.</p>
          <p id="userInfo">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø¯Ù…Ø©...</p>
        </div>
      </div>
    </div>
  </footer>

</main>

<!-- MODALS -->
<div id="smartInputModal" class="modal no-print">
  <div class="modal-content">
    <span class="close-btn" onclick="closeModal('smartInputModal')">&times;</span>
    <h2 class="text-3xl font-extrabold mb-6 pb-2 border-b" style="color:var(--color-navy);">
      ÙˆØ­Ø¯Ø© Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø°ÙƒÙŠ Ù„Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª (Smart HSR)
    </h2>

    <div id="modalStep1">
      <p class="text-lg text-gray-600 mb-4">
        Ø§Ù„Ø®Ø·ÙˆØ© 1: Ø£Ø¯Ø®Ù„ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø© (Ø§Ù„Ù†ØµØŒ Ø§Ù„Ù…ÙˆÙ‚Ø¹ØŒ Ø§Ù„ØµÙˆØ±Ø©)
      </p>
      <textarea id="rawObservationInput" rows="5" class="w-full p-4 border border-gray-300 rounded-xl focus:ring-[--color-teal] focus:border-[--color-teal] text-gray-700 shadow-sm" placeholder="Ù…Ø«Ø§Ù„: ÙŠÙˆØ¬Ø¯ ØªØ¬Ù…Ø¹ Ù„Ù„Ù…ÙŠØ§Ù‡ Ø¹Ù„Ù‰ Ø·Ø±ÙŠÙ‚ Ø§Ù„Ø®Ø¯Ù…Ø© Ø¹Ù†Ø¯ Ø§Ù„ÙƒÙŠÙ„Ùˆ 52..." oninput="checkSmartInputState()"></textarea>

      <div class="mt-4 input-group-wrapper">
        <div class="input-group p-4 border-2 border-dashed border-gray-300 rounded-xl bg-white hover:border-teal-500 transition-colors">
          <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ (GPS):</label>
          <p id="locationStatus" class="text-sm font-semibold text-gray-500">Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ¯ Ø¨Ø¹Ø¯</p>
          <input type="hidden" id="inputLatitude">
          <input type="hidden" id="inputLongitude">
          <button id="getLocationBtn" class="ai-button-primary rounded-full px-4 py-2 text-sm font-bold mt-2 flex items-center justify-center mx-auto" onclick="getLocation()" type="button">
            <i data-lucide="map-pin" class="w-4 h-4 ml-2"></i> ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø­Ø§Ù„ÙŠ
          </button>
        </div>

        <div class="input-group p-4 border-2 border-dashed border-gray-300 rounded-xl bg-white hover:border-teal-500 transition-colors">
          <label class="block text-sm font-medium text-gray-700 mb-2">Ø±ÙØ¹ ØµÙˆØ±Ø© Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©:</label>
          <p id="fileStatus" class="text-sm font-semibold text-gray-500">Ù„Ù… ÙŠØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù Ø¨Ø¹Ø¯</p>
          <input type="file" id="fileUploadInput" accept="image/*" class="hidden" onchange="handleFileUpload(event)">
          <button class="ai-button-secondary rounded-full px-4 py-2 text-sm font-bold mt-2 flex items-center justify-center mx-auto" onclick="document.getElementById('fileUploadInput').click()" type="button">
            <i data-lucide="upload" class="w-4 h-4 ml-2"></i> Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù
          </button>
        </div>
      </div>

      <div class="mt-6 text-center">
        <button id="processSmartInputBtn" class="ai-button-vision rounded-full px-8 py-3 text-lg font-bold flex items-center justify-center mx-auto" onclick="processSmartInput()" disabled>
          <i data-lucide="cpu" class="w-5 h-5 ml-2"></i> Ø¨Ø¯Ø¡ Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø°ÙƒÙŠ ÙˆØªÙˆÙ„ÙŠØ¯ Ø§Ù„ØªÙ‚Ø±ÙŠØ±
        </button>
      </div>
    </div>

    <div id="modalResult" class="mt-8 pt-6 border-t border-gray-200 hidden">
      <h3 class="text-2xl font-bold mb-4" style="color:var(--color-teal);">Ø§Ù„Ø®Ø·ÙˆØ© 2: Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h3>
      <div id="modalResultContent"></div>
      <div class="mt-6 text-center">
        <button class="ai-button-primary rounded-full px-6 py-2 text-md font-bold" onclick="closeModal('smartInputModal')">
          Ø¥ØºÙ„Ø§Ù‚ ÙˆÙ…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯
        </button>
      </div>
    </div>
  </div>
</div>

<div id="closeoutModal" class="modal no-print">
  <div class="modal-content">
    <span class="close-btn" onclick="closeModal('closeoutModal'); clearAfterUpload();">&times;</span>
    <h2 class="text-3xl font-extrabold mb-6 pb-2 border-b text-green-700">
      ğŸ”’ Ù„ÙˆØ­Ø© Ø§Ù„Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ØªÙ†ÙÙŠØ°ÙŠ Ù„Ù„Ù…Ù„Ø§Ø­Ø¸Ø© #<span id="closeoutId"></span>
    </h2>
    <p class="text-lg text-gray-600 mb-4">
      Ù„Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©ØŒ ÙŠØ¬Ø¨ ØªÙˆØ«ÙŠÙ‚ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø¥ØµÙ„Ø§Ø­ Ø¨Ù€ <b>ØµÙˆØ±Ø© "Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ØµÙ„Ø§Ø­"</b> ÙˆÙ…Ø°ÙƒØ±Ø© Ø®ØªØ§Ù…ÙŠØ©.
    </p>

    <div class="p-6 bg-gray-50 rounded-xl border border-gray-200">
      <h3 class="text-xl font-bold mb-3" style="color:var(--color-navy);">
        1. ØªÙˆØ«ÙŠÙ‚ ØµÙˆØ±Ø© Ø§Ù„Ø¥ØºÙ„Ø§Ù‚ (After Photo)
      </h3>
      <div class="input-group p-4 border-2 border-dashed border-red-300 rounded-xl bg-white hover:border-red-500 transition-colors">
        <label class="block text-sm font-medium text-gray-700 mb-2">
          Ø±ÙØ¹ ØµÙˆØ±Ø© <b>Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ØµÙ„Ø§Ø­/Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©</b> (<span class="text-red-500 font-bold">Ø¥Ù„Ø²Ø§Ù…ÙŠ</span>):
        </label>
        <p id="afterFileStatus" class="text-sm font-semibold text-gray-500">
          Ù„Ù… ÙŠØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù Ø¨Ø¹Ø¯
        </p>
        <input type="file" id="afterFileUploadInput" accept="image/*" class="hidden" onchange="handleAfterFileUpload(event)">
        <button class="ai-button-primary rounded-full px-4 py-2 text-sm font-bold mt-2 flex items-center justify-center mx-auto" onclick="document.getElementById('afterFileUploadInput').click()" type="button">
          <i data-lucide="camera" class="w-4 h-4 ml-2"></i> Ø§Ø®ØªÙŠØ§Ø± ØµÙˆØ±Ø© Ø§Ù„Ø¥ØºÙ„Ø§Ù‚
        </button>
      </div>

      <h3 class="text-xl font-bold mt-6 mb-3" style="color:var(--color-navy);">2. Ø§Ù„Ù…Ø°ÙƒØ±Ø© Ø§Ù„Ø®ØªØ§Ù…ÙŠØ©</h3>
      <textarea id="resolutionNoteInput" rows="4" class="w-full p-3 border border-gray-300 rounded-xl focus:ring-green-500 focus:border-green-500 text-gray-700 shadow-sm" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ù…Ø°ÙƒØ±Ø© Ø§Ù„Ø®ØªØ§Ù…ÙŠØ©..."></textarea>
    </div>

    <div class="mt-6 text-center">
      <button id="finalCloseoutBtn" class="bg-green-600 hover:bg-green-700 rounded-full px-8 py-3 text-lg font-bold flex items-center justify-center mx-auto transition-colors" onclick="completeObservation()" disabled>
        <i data-lucide="check-square" class="w-5 h-5 ml-2"></i> ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ù„Ù„Ù…Ù„Ø§Ø­Ø¸Ø©
      </button>
    </div>
  </div>
</div>

<script src="modal-script.js"></script>

<!-- GEO STATUS -->
<script>
function updateGpsStatus() {
  const gpsCircle = document.querySelector("#gpsIndicator .circle");
  const gpsText = document.getElementById("gpsText");

  if (!navigator.geolocation) {
    gpsText.textContent = "ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…";
    gpsCircle.classList.add("off");
    gpsCircle.classList.remove("on");
    return;
  }

  gpsText.textContent = "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ø¯ÙŠØ¯...";
  gpsCircle.classList.add("off");
  gpsCircle.classList.remove("on");

  navigator.geolocation.getCurrentPosition(
    (pos) => {
      gpsText.textContent = "Ù†Ø´Ø·";
      gpsCircle.classList.add("on");
      gpsCircle.classList.remove("off");
    },
    (err) => {
      gpsText.textContent = "ØºÙŠØ± Ù…ØªØ§Ø­";
      gpsCircle.classList.add("off");
      gpsCircle.classList.remove("on");
    },
    { enableHighAccuracy: true, timeout: 5000 }
  );
}

document.addEventListener("DOMContentLoaded", () => {
  updateGpsStatus();
});
setInterval(updateGpsStatus, 60000);
</script>

<!-- MAIN APP (Firebase + Firestore + Storage + AI via Google Apps Script) -->


</body>
</html>
