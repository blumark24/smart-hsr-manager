<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Smart HSR - تسجيل الدخول</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800;900&display=swap" rel="stylesheet">
    
    <style>
        /* الألوان: مستوحاة من هويتك (Teal/Navy) */
        :root{
            --primary-teal:#0ea5a1; /* Teal 500 */
            --secondary-navy:#0b2b3a; /* Dark Navy */
            --card-bg:#ffffff;
            --button-shadow: rgba(14, 165, 161, 0.4);
        }
        *{box-sizing:border-box}
        body{
            margin:0;
            font-family:'Tajawal', sans-serif; /* استخدام خط عربي حديث */
            background:linear-gradient(180deg,#f7f9fb 0%,#f0f2f5 100%);
            min-height:100vh;
            display:flex;
            align-items:center;
            justify-content:center;
            padding:30px;
        }
        .card{
            width:380px;
            background:var(--card-bg);
            border-radius:24px; /* زوايا أكثر استدارة وفخامة */
            box-shadow:0 15px 40px rgba(10,20,50,0.15); /* ظل احترافي */
            padding:40px 30px;
            border: 1px solid #e9ecef; /* خط خفيف حول البطاقة */
            position:relative;
            overflow:hidden;
            transition: all 0.3s ease;
        }
        .card:hover{
             box-shadow:0 18px 45px rgba(14, 165, 161, 0.2);
        }
        
        h1{margin:0 0 4px 0;text-align:center;font-size:32px;color:var(--secondary-navy);font-weight:900;}
        p.lead{margin:0 0 25px 0;text-align:center;color:#6c757d;font-weight:500;font-size:16px;}
        
        /* شريط التمييز العلوي (هوية الشركات الكبرى) */
        .card-header-line{
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, var(--primary-teal), var(--secondary-navy));
            border-top-left-radius: 24px;
            border-top-right-radius: 24px;
        }

        .field{margin-bottom:18px}.field label{display:block;margin-bottom:8px;color:var(--secondary-navy);font-size:14px;font-weight:600;}
        input[type="email"],input[type="password"]{
            width:100%;
            padding:14px 18px;
            border-radius:12px;
            border:1px solid #d4dce4;
            background:#f8f9fa;
            font-size:16px;
            outline:none;
            transition: border-color 0.3s, box-shadow 0.3s;
        }
        input:focus{
            border-color:var(--primary-teal);
            box-shadow:0 0 0 3px rgba(14, 165, 161, 0.1);
            background:white;
        }
        .btn{
            width:100%;
            padding:14px;
            border-radius:12px;
            border:none;
            cursor:pointer;
            font-weight:700;
            font-size:17px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .btn-primary{
            background:linear-gradient(90deg, var(--primary-teal), #0b7285);
            color:white;
            box-shadow:0 10px 20px var(--button-shadow);
        }
        .btn-primary:hover:not(:disabled){
            transform: translateY(-2px);
            box-shadow:0 12px 25px var(--button-shadow);
            background:linear-gradient(90deg, #0b7285, var(--primary-teal));
        }
        .message{text-align:center;margin-top:15px;font-weight:600;font-size:15px;}
        .error{color:#dc3545;} /* أحمر قوي للأخطاء */
        .success{color:#198754;}
        .muted{font-size:13px;color:#7b8a90;text-align:center;margin-top:15px;}
        
        .loading-spinner {
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-top: 3px solid white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
            margin-left: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        @media (max-width:420px){.card{width:95%;padding:30px 20px;}}
    </style>
</head>
<body>

<div class="card" role="main">
  <div class="card-header-line"></div>
  <h1>Smart HSR</h1>
  <p class="lead">تسجيل الدخول إلى لوحة القيادة التنفيذية</p>

  <form id="loginForm" onsubmit="event.preventDefault(); signInWithEmail();">
    <div class="field">
      <label for="email">البريد الإلكتروني (المعتمد):</label>
      <input id="email" type="email" placeholder="example@smart-hsr.com" required />
    </div>
    <div class="field">
      <label for="password">كلمة المرور:</label>
      <input id="password" type="password" placeholder="كلمة المرور السرية" required />
    </div>
    
    <button type="submit" id="loginButton" class="btn btn-primary" style="margin-top:10px;">
        تسجيل الدخول
    </button>
  </form>

  <div id="msg" class="message"></div>
  <div class="muted">هذا النظام مخصص للموظفين التنفيذيين والمراقبين المعتمدين فقط.</div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-app.js";
import { getAuth, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-auth.js";

// إعداد مشروع Firebase الفعلي الخاص بك
const firebaseConfig = {
  apiKey: "AIzaSyBfClVxFIXgUXL4olEv5SepUDtzk0dq3lo",
  authDomain: "gen-lang-client-0349944917.firebaseapp.com",
  projectId: "gen-lang-client-0349944917",
  storageBucket: "gen-lang-client-0349944917.firebasestorage.app",
  messagingSenderId: "883065484771",
  appId: "1:883065484771:web:c907bb5a51f68caad75cd6"
};


const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const loginButton = document.getElementById('loginButton');

function msg(t, type) {
    const el = document.getElementById('msg');
    el.innerText = t || '';
    el.className = 'message ' + (type || '');
}

window.signInWithEmail = async function () {
    const email = document.getElementById('email').value.trim();
    const password = document.getElementById('password').value;
    
    if (!email || !password) {
        msg('أدخل البريد الإلكتروني وكلمة المرور أولاً.','error');
        return;
    }
    
    // وضع زر التحميل
    loginButton.disabled = true;
    loginButton.innerHTML = `<div class="loading-spinner"></div> جاري الدخول...`;

    try {
        await signInWithEmailAndPassword(auth, email, password);
        msg('تم تسجيل الدخول بنجاح. جاري التوجيه...','success');
        
        // التوجيه إلى صفحة لوحة القيادة
        window.location.href="index.html"; 
    } catch(e) {
        let errorMessage = 'خطأ في تسجيل الدخول. تأكد من البريد وكلمة المرور.';
        if (e.code === 'auth/user-not-found' || e.code === 'auth/wrong-password') {
             errorMessage = 'البريد الإلكتروني أو كلمة المرور غير صحيحة.';
        } else if (e.code === 'auth/too-many-requests') {
             errorMessage = 'تم حظر الحساب مؤقتاً بسبب محاولات كثيرة فاشلة.';
        }
        
        msg(errorMessage, 'error');
        
        // إعادة تفعيل الزر
        loginButton.disabled = false;
        loginButton.innerHTML = `تسجيل الدخول`;
    }
}
</script>
</body>
</html>
